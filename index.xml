<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>å¾æ—­ çš„åšå®¢</title><link>https://mogutou.xyz/</link><description>Recent content on å¾æ—­ çš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 20 Apr 2021 11:22:38 +0800</lastBuildDate><atom:link href="https://mogutou.xyz/index.xml" rel="self" type="application/rss+xml"/><item><title>Go1.16 embed å’Œ Vue</title><link>https://mogutou.xyz/posts/practice/gin-vue/</link><pubDate>Tue, 20 Apr 2021 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/practice/gin-vue/</guid><description>vue ç›¸å…³ä»£ç ï¼š https://github.com/Allenxuxu/ginvue
å…ˆå…¨å±€å®‰è£…ä¸‹ vue cli å¹¶åˆ›å»ºä¸€ä¸ª demo é¡¹ç›®
npm install -g @vue/cli vue create web ç„¶åæˆ‘ä»¬è¿›å…¥ web ç›®å½•ï¼Œä¿®æ”¹ç”Ÿæˆçš„ package.json æ–‡ä»¶è°ƒæ•´ä¸€ä¸‹ build ç”Ÿæˆçš„é™æ€æ–‡ä»¶ç›®å½•ã€‚
&amp;ndash;dest æ˜¯æŒ‡å®šè¾“å‡ºçš„ç›®å½•
**&amp;ndash;no-clean æ˜¯è®©ä»–ä¸è¦æ¯æ¬¡è¦†ç›–æˆ‘ä»¬çš„ç›®å½•ï¼Œå› ä¸ºåé¢æˆ‘ä»¬ä¼šæ”¾ä¸€ä¸ª go æ–‡ä»¶åˆ°é‚£ä¸ªç›®å½•ã€‚ **
&amp;quot;build&amp;quot;: &amp;quot;vue-cli-service build --no-clean --dest ../static&amp;quot;, å†æ–°å¢ä¸€ä¸ª vue.config.js æ–‡ä»¶æ¥ä¿®æ”¹ä¸‹ , è¿™é‡Œå°† production çš„ publicPath ä¿®æ”¹æˆå¸¦ä¸€ä¸ªå‰ç¼€ /ui/ , è¿™é‡Œä¸»è¦å°±æ˜¯ä¸ºäº†åé¢æˆ‘ä»¬çš„go ä»£ç è·¯ç”±è®¾ç½®æ–¹ä¾¿ï¼Œæ‰€æœ‰çš„å‰ç«¯é™æ€æ–‡ä»¶è¯·æ±‚éƒ½å¸¦ä¸Š /ui å‰ç¼€ï¼Œå’Œåç«¯ API æ¥å£å¸¦ /api å‰ç¼€åŒºåˆ†ã€‚
module.exports = { publicPath: process.env.NODE_ENV === 'production' ? '/ui/' : '/' } æœ€åæˆ‘ä»¬å† web ç›®å½•è¿è¡Œ npm run buildï¼Œä¼šç”Ÿæˆä¸€ä¸ª static ç›®å½•ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¿®æ”¹çš„ package.</description></item><item><title>Golang slice map channel å°æŠ€å·§</title><link>https://mogutou.xyz/posts/go/go-slice-map-channel/</link><pubDate>Sat, 17 Apr 2021 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go/go-slice-map-channel/</guid><description>Slice vs Array Slice å’Œ Array æ˜¯ä¸åŒçš„ç±»å‹ package main func main() { s := make([]int, 100) printSlice(s) var a [100]int printArray(a) } func printSlice(s []int) { println(len(s)) // 100 println(cap(s)) // 100 } func printArray(a [100]int) { println(len(a)) // 100 println(cap(a)) // 100 } Slice ç»“æ„ä½“
type slice struct { array unsafe.Pointer len int cap int } ä¸‹é¢çš„æ±‡ç¼–è¡¨æ˜ï¼Œå½“ç±»å‹æ˜¯ slice çš„æ—¶å€™ï¼Œæ‰“å° len æˆ–è€… cap çš„æ—¶å€™ï¼Œä¼šå»æ ˆä¸Šå–æ•°æ®:
MOVQ 0x28(SP), AX MOVQ AX, 0x8(SP) CALL 0xbfc [1:5]R_CALL:runtime.</description></item><item><title>RocketMQ è®¾è®¡ä¸ç†è§£</title><link>https://mogutou.xyz/posts/mq/rocketmq/</link><pubDate>Mon, 05 Apr 2021 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/mq/rocketmq/</guid><description>æ•´ä½“æ¶æ„ RocketMQ ä¸»è¦ç”± Producerã€Brokerã€Consumerã€Name Server å››ä¸ªéƒ¨åˆ†ç»„æˆã€‚
å…¶ä¸­Producer è´Ÿè´£ç”Ÿäº§æ¶ˆæ¯ï¼ŒConsumer è´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼ŒBroker è´Ÿè´£å­˜å‚¨æ¶ˆæ¯ï¼ŒName server å……å½“è·¯ç”±æ¶ˆæ¯çš„æä¾›è€…ã€‚
æ¯ä¸ª Broker å¯ä»¥å­˜å‚¨å¤šä¸ªTopicçš„æ¶ˆæ¯ï¼Œæ¯ä¸ªTopicçš„æ¶ˆæ¯ä¹Ÿå¯ä»¥åˆ†ç‰‡å­˜å‚¨äºä¸åŒçš„ Brokerã€‚Message Queue ç”¨äºå­˜å‚¨æ¶ˆæ¯çš„ç‰©ç†åœ°å€ï¼Œæ¯ä¸ªTopicä¸­çš„æ¶ˆæ¯åœ°å€å­˜å‚¨äºå¤šä¸ª Message Queue ä¸­ã€‚
Topic Topic æ˜¯ä¸€ç§é€»è¾‘ä¸Šçš„åˆ†åŒºï¼Œæ˜¯åŒä¸€ç±»æ¶ˆæ¯çš„é›†åˆï¼Œæ¯ä¸€ä¸ªæ¶ˆæ¯åªèƒ½å±äºä¸€ä¸ª Topic ï¼Œæ˜¯RocketMQè¿›è¡Œæ¶ˆæ¯è®¢é˜…çš„åŸºæœ¬å•ä½ã€‚
æ¯ä¸ª topic ä¼šè¢«åˆ†æˆå¾ˆå¤š Messsage Queue ï¼Œå’Œ Kafka ä¸­çš„ Partition æ¦‚å¿µä¸€æ ·ï¼Œtopic çš„æ•°æ®è¢«åˆ†å¸ƒåœ¨ä¸åŒçš„ Message Queue ä¸­ã€‚
åœ¨ä¸šåŠ¡å¢é•¿ï¼Œæ¶ˆæ¯é‡å¢å¤§æ—¶ï¼Œå¯ä»¥å¢å¤§ topic çš„ Message Queueï¼Œè¿™æ ·å¯ä»¥å°†å‹åŠ›åˆ†æ‘Šåˆ°æ›´å¤šçš„ broker ä¸Šã€‚å› ä¸º Producer å¯ä»¥å‘é€æ¶ˆæ¯çš„æ—¶å€™å¯ä»¥é€šè¿‡æŒ‡å®šçš„ç®—æ³•ï¼Œå°†æ¶ˆæ¯å‡åŒ€çš„å‘é€åˆ°æ¯ä¸ª Message Queueã€‚
NameServer ç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…èƒ½å¤Ÿé€šè¿‡ Name ServeræŸ¥æ‰¾å„ Topic ç›¸åº”çš„Broker IP åˆ—è¡¨ã€‚ Name Server å¯ä»¥å¤šæœºéƒ¨ç½²å˜æˆä¸€ä¸ªé›†ç¾¤ä¿è¯é«˜å¯ç”¨ï¼Œä½†è¿™äº›æœºå™¨é—´å½¼æ­¤å¹¶ä¸é€šä¿¡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸‰è€…çš„å…ƒæ•°æ®èˆå¼ƒäº†å¼ºä¸€è‡´æ€§ã€‚
æ¯ä¸€ä¸ª broker å¯åŠ¨æ—¶ä¼šå‘å…¨éƒ¨çš„ Name server æœºå™¨æ³¨å†Œå¿ƒè·³ï¼Œå¿ƒè·³é‡ŒåŒ…å«è‡ªå·±æœºå™¨ä¸Š Topic çš„æ‹“æ‰‘ä¿¡æ¯ï¼Œä¹‹åæ¯éš” 30s æ›´æ–°ä¸€æ¬¡ï¼Œç„¶åç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¯åŠ¨çš„æ—¶å€™ä»»é€‰ä¸€å° Name Server æœºå™¨æ‹‰å–æ‰€éœ€çš„ Topic çš„è·¯ç”±ä¿¡æ¯ç¼“å­˜åœ¨æœ¬åœ°å†…å­˜ä¸­ï¼Œä¹‹åæ¯éš” 30s å®šæ—¶ä»è¿œç«¯æ‹‰å–æ›´æ–°æœ¬åœ°ç¼“å­˜ã€‚</description></item><item><title>git ä¿®æ”¹å·²ç» commit çš„é‚®ç®±ä¿¡æ¯</title><link>https://mogutou.xyz/posts/practice/git-amend/</link><pubDate>Thu, 10 Sep 2020 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/practice/git-amend/</guid><description>å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šå‡ºç°æäº¤é‚®ç®±æé”™çš„æƒ…å†µã€‚åœ¨å…¬å¸é¡¹ç›®ä¸­é”™è¯¯æäº¤äº†è‡ªå·±çš„ GitHub é‚®ç®±ï¼Œæˆ–è€…åœ¨å¼€æºé¡¹ç›®ä¸­æäº¤äº†å…¬å¸é‚®ç®±ã€‚
ä¸‹é¢è®°å½•ä¸€ä¸‹è¡¥æ•‘æªæ–½ã€‚
å…ˆä¿®æ”¹ .git/config æˆ–è€… ä¿®æ”¹å…¨å±€çš„ï¼Œä¿®æ”¹æˆä½ éœ€è¦çš„é‚®ç®±ä¿¡æ¯ã€‚
[user] email = name@qq.com name = yourname git log æ‰¾åˆ°è¦ä¿®æ”¹çš„é‚£ä¸€æ¡ commitï¼Œå¤åˆ¶è¦ä¿®æ”¹çš„commit çš„å‰ä¸€æ¡ commit çš„å“ˆå¸Œå€¼ã€‚
git rebase -i {{åˆšåˆšå¤åˆ¶çš„å“ˆå¸Œå€¼}}
ç„¶ååä¼šå‡ºç°ä¸€ä¸ª vim æ‰“å¼€çš„æ–‡æœ¬ï¼Œå°†éœ€è¦ä¿®æ”¹çš„ commit ä¿¡æ¯å‰é¢çš„ pick æ–‡æœ¬æ”¹æˆ editï¼Œä¿å­˜é€€å‡ºã€‚
ä¿®æ”¹é‚®ç®±ä¿¡æ¯
git commit --amend --author=&amp;quot;name &amp;lt;name@qq.com&amp;gt;&amp;quot; --no-edit
è¿™æ—¶å€™æŸ¥çœ‹ git log ä¿¡æ¯ï¼Œå‘ç°é‚®ç®±å·²ç»æ›´æ”¹äº†ã€‚
å¼ºåˆ¶ push åˆ°è¿œç¨‹ï¼ˆæ³¨æ„é£é™©ï¼‰
git push -f origin HEAD:master
doneï¼</description></item><item><title>golang protobuf å­—æ®µä¸ºé›¶å€¼æ—¶ json åºåˆ—åŒ–å¿½ç•¥é—®é¢˜</title><link>https://mogutou.xyz/posts/practice/protobuf-json/</link><pubDate>Tue, 02 Jun 2020 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/practice/protobuf-json/</guid><description>protoc ç¼–è¯‘ç”Ÿæˆçš„ pb.go æ–‡ä»¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ tag ä¸­ä¼šè®¾ç½® json å¿½ç•¥é›¶å€¼çš„è¿”å›å±æ€§ omitemptyã€‚
type Message struct { Header map[string]string `protobuf:&amp;#34;bytes,1,rep,name=header,proto3&amp;#34; json:&amp;#34;header,omitempty&amp;#34; protobuf_key:&amp;#34;bytes,1,opt,name=key,proto3&amp;#34; protobuf_val:&amp;#34;bytes,2,opt,name=value,proto3&amp;#34;` Body []byte `protobuf:&amp;#34;bytes,2,opt,name=body,proto3&amp;#34; json:&amp;#34;body,omitempty&amp;#34;` XXX_NoUnkeyedLiteral struct{} `json:&amp;#34;-&amp;#34;` XXX_unrecognized []byte `json:&amp;#34;-&amp;#34;` XXX_sizecache int32 `json:&amp;#34;-&amp;#34;` } ä¸€ä¸ªæ¯”è¾ƒ hack çš„æ–¹å¼ï¼Œæ˜¯åœ¨ pb.go æ–‡ä»¶ç”Ÿæˆåï¼Œæ‰‹åŠ¨å»åˆ æ‰ omitempty ã€‚æ¯æ¬¡æ‰‹åŠ¨å»åˆ é™¤ï¼Œæ¯”è¾ƒéº»çƒ¦ä¸”å®¹æ˜“å‡ºé”™ï¼Œä¸‹é¢æä¾›ä¸€ä¸ª Makefile ï¼Œæ¯æ¬¡ç”Ÿæˆ pb.go çš„æ—¶å€™å°±å»åˆ é™¤ omitempty ã€‚
proto: protoc --proto_path=. --go_out=. --micro_out=. config/config.proto ls config/*.pb.go | xargs -n1 -IX bash -c &amp;#39;sed s/,omitempty// X &amp;gt; X.tmp &amp;amp;&amp;amp; mv X{.tmp,}&amp;#39; proto ç›®æ ‡çš„ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯è°ƒç”¨ protoc æ ¹æ® config/config.</description></item><item><title>go chan å®ç”¨ç¤ºä¾‹</title><link>https://mogutou.xyz/posts/go/go-channel/</link><pubDate>Sat, 30 May 2020 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go/go-channel/</guid><description>å°è¯•å‘é€ select { case c &amp;lt;- struct{}{}: default: fmt.Println(&amp;#34;chan å·²æ»¡ï¼Œå‘é€ä¸æˆåŠŸ&amp;#34;) } å°è¯•æ¥æ”¶ select { case v := &amp;lt;- c: default: fmt.Println(&amp;#34;chan ä¸­æ²¡æœ‰ä¿¡æ¯ï¼Œæ¥æ”¶ä¸æˆåŠŸ&amp;#34;) } æ ‡å‡†ç¼–è¯‘å™¨å¯¹å°è¯•å‘é€å’Œå°è¯•æ¥æ”¶ä»£ç å—åšäº†ç‰¹åˆ«çš„ä¼˜åŒ–ï¼Œä½¿å¾—å®ƒä»¬çš„æ‰§è¡Œæ•ˆç‡æ¯”å¤š caseåˆ†æ”¯çš„æ™®é€š selectä»£ç å—æ‰§è¡Œæ•ˆç‡é«˜å¾—å¤šã€‚
æ— é˜»å¡çš„æ£€æŸ¥ä¸€ä¸ª chan æ˜¯å¦å…³é—­ å‡è®¾æˆ‘ä»¬å¯ä»¥ä¿è¯æ²¡æœ‰ä»»ä½•åç¨‹ä¼šå‘ä¸€ä¸ªé€šé“å‘é€æ•°æ®ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥ï¼ˆå¹¶å‘å®‰å…¨åœ°ï¼‰æ£€æŸ¥æ­¤é€šé“æ˜¯å¦å·²ç»å…³é—­ï¼Œæ­¤æ£€æŸ¥ä¸ä¼šé˜»å¡å½“å‰åç¨‹ã€‚
func IsClosed(c chan struct{}) bool { select { case &amp;lt;-c: return true default: } return false } æœ€å¿«å›åº” package main import ( &amp;#34;fmt&amp;#34; &amp;#34;math/rand&amp;#34; &amp;#34;time&amp;#34; ) func source(c chan&amp;lt;- int, id int) { rb := rand.</description></item><item><title>äºŒå‰å †ä¸å †æ’åº</title><link>https://mogutou.xyz/posts/algorithm/heap/</link><pubDate>Sat, 30 May 2020 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/algorithm/heap/</guid><description>äºŒå‰å †æ˜¯ä¸€ç»„èƒ½å¤Ÿç”¨å †æœ‰åºçš„å®Œå…¨äºŒå‰æ ‘æ’åºçš„å…ƒç´ ï¼Œä¸€èˆ¬ç”¨æ•°ç»„æ¥å­˜å‚¨ã€‚
å¤§é¡¶å †ï¼Œ æ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½å¤§äºæˆ–ç­‰äºå…¶å·¦å³å­©å­ç»“ç‚¹çš„å€¼ï¼Œå…¶é¡¶éƒ¨ä¸ºæœ€å¤§å€¼ã€‚
å°é¡¶å †ï¼Œæ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½å°äºæˆ–ç­‰äºå…¶å·¦å³å­©å­ç»“ç‚¹çš„å€¼ï¼Œå…¶é¡¶éƒ¨ä¸ºæœ€å°å€¼ã€‚
äºŒå‰å † æ€§è´¨ æ ¹èŠ‚ç‚¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®æ˜¯ 1 å·¦è¾¹å­èŠ‚ç‚¹ 2i å³å­èŠ‚ç‚¹ 2i+1 çˆ¶èŠ‚ç‚¹ i / 2 æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹ä¸º len / 2 æ ¹èŠ‚ç‚¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®æ˜¯ 0 å·¦å­èŠ‚ç‚¹ 2i + 1 å³è¾¹å­èŠ‚ç‚¹ 2i+ 2 çˆ¶èŠ‚ç‚¹çš„ä¸‹æ ‡æ˜¯ (i âˆ’ 1) / 2 æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹ä¸º len / 2 - 1 å›¾ç‰‡æ¥è‡ªçŸ¥ä¹
å®ç° æ„é€ äºŒå‰å † æ‰¾åˆ°æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹ ( len / 2 æˆ–è€… len / 2 - 1ï¼‰ ä»æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹ä¸‹æ ‡ç´¢å¼•å¼€å§‹é€’å‡ï¼Œé€ä¸ªä¸‹æ²‰ æ’å…¥èŠ‚ç‚¹ åœ¨æ•°ç»„çš„æœ€æœ«å°¾æ’å…¥æ–°èŠ‚ç‚¹ å°†æœ€åä¸€ä¸ªèŠ‚ç‚¹ä¸Šæµ®ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(log n) æ¯”è¾ƒå½“å‰èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹ ä¸æ»¡è¶³ å †æ€§è´¨* *åˆ™äº¤æ¢ åˆ é™¤æ ¹èŠ‚ç‚¹ åˆ é™¤æ ¹èŠ‚ç‚¹ç”¨äºå †æ’åº</description></item><item><title>äºŒå‰æ ‘çš„éå†æ¨¡ç‰ˆï¼ˆé€’å½’ï¼Œè¿­ä»£ï¼‰</title><link>https://mogutou.xyz/posts/algorithm/tree-traversal/</link><pubDate>Sun, 26 Apr 2020 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/algorithm/tree-traversal/</guid><description>å›¾ç‰‡æ¥è‡ª leetcode
æ·±åº¦ä¼˜å…ˆéå†ï¼ˆdfsï¼‰ å‰åºéå† ä¸­åºéå† ååºéå† å¹¿åº¦ä¼˜å…ˆéå†ï¼ˆbfsï¼‰ type TreeNode struct { Val int Left *TreeNode Right *TreeNode } æ·±åº¦ä¼˜å…ˆéå† é€’å½’ é€’å½’ç‰ˆæœ¬ï¼Œä»£ç æ¯”è¾ƒç®€å•ï¼Œåªéœ€æ”¹å˜ append æ•°æ®çš„ä½ç½®å³å¯ã€‚
å‰åºéå† func preorderTraversal(root *TreeNode) []int { var ret []int helper(root, &amp;amp;ret) return ret } func helper(root *TreeNode, data *[]int) { if root == nil { return } *data = append(*data, root.Val) helper(root.Left, data) helper(root.Right, data) } ä¸­åºéå† func inorderTraversal(root *TreeNode) []int { var ret []int helper(root, &amp;amp;ret) return ret } func helper(root *TreeNode, data *[]int) { if root == nil { return } helper(root.</description></item><item><title>Github Actions é…ç½® CI/CD è‡ªåŠ¨å‘å¸ƒ docker é•œåƒ</title><link>https://mogutou.xyz/posts/practice/github-action-docker/</link><pubDate>Thu, 02 Apr 2020 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/practice/github-action-docker/</guid><description>Github Actions æ˜¯ Github å†…ç½®çš„ CI/CD å·¥å…·ï¼Œç°åœ¨å·²ç»å¯¹æ‰€æœ‰çš„å¼€æºé¡¹ç›®å…è´¹å¼€æ”¾äº†ã€‚
æœ¬æ–‡ä¸»è¦è®°å½•ä½¿ç”¨ Github Actions å®è·µ CI/CD çš„ä¸€äº›é…ç½®ã€‚
åŠŸèƒ½ç›®æ ‡ ä»£ç é™æ€æ£€æŸ¥ ä»£ç å•å…ƒæµ‹è¯• release/tag æ—¶è‡ªåŠ¨ build é•œåƒå¹¶æ¨é€åˆ° docker hub é¡¹ç›® Dockerfile å’Œ Makefile é¡¹ç›®ä¸»è¦ç›®å½•
. â”œâ”€â”€ LICENSE â”œâ”€â”€ Makefile â”œâ”€â”€ README.md â”œâ”€â”€ config-srv â”‚ â”œâ”€â”€ Makefile â”‚ â””â”€â”€ main.go â”œâ”€â”€ deployments â”‚ â”œâ”€â”€ docker â”‚ â”‚ â”œâ”€â”€ config-srv â”‚ â”‚ â”‚ â””â”€â”€ Dockerfile â”œâ”€â”€ go.mod â”œâ”€â”€ go.sum config-srv ç›®å½•ï¼šæœåŠ¡ä»£ç  deployments ç›®å½•ï¼šæ‰€æœ‰æœåŠ¡çš„ Dockerfile Makefile é¡¶å±‚ Makefileï¼šbuild Docker é•œåƒ æˆ‘ä»¬å…ˆçœ‹ä¸‹é¡¶å±‚çš„ Makefile</description></item><item><title>go-micro åŠ¨æ€åŠ è½½æ’ä»¶æºç åˆ†æ</title><link>https://mogutou.xyz/posts/go-micro/go-micro-plugin/</link><pubDate>Sat, 28 Mar 2020 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go-micro/go-micro-plugin/</guid><description>go-micro æ¡†æ¶æ”¯æŒåŠ¨æ€åŠ è½½æ’ä»¶ï¼Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚
æºç åˆ†æ å¯åŠ¨æœåŠ¡å‰ï¼Œè®¾å®š MICRO_PLUGIN ç¯å¢ƒå˜é‡æŒ‡å®šåŠ¨æ€åº“ .so æ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒå¤šä¸ªæ’ä»¶ï¼Œé€—å·åˆ†å‰²ã€‚ç¨‹åºå¯åŠ¨å‰ä¼šè¯»å– MICRO_PLUGIN ç¯å¢ƒå˜é‡ï¼Œå¹¶å®Œæˆæ’ä»¶è®¾å®šã€‚
ä¸‹é¢æ˜¯å…¶å†…éƒ¨å®ç°ï¼š
go-micro/service.go
func (s *service) Init(opts ...Option) { ... // setup the plugins for _, p := range strings.Split(os.Getenv(&amp;quot;MICRO_PLUGIN&amp;quot;), &amp;quot;,&amp;quot;) { if len(p) == 0 { continue } // åŠ è½½ .so æ–‡ä»¶ c, err := plugin.Load(p) if err != nil { logger.Fatal(err) } // go-micro åˆå§‹åŒ–æ’ä»¶ if err := plugin.Init(c); err != nil { logger.Fatal(err) } } ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œservice åˆå§‹åŒ–åŒ–çš„æ—¶å€™ï¼Œè¯»å– MICRO_PLUGIN ç¯å¢ƒå˜é‡ä¸­æŒ‡å®šçš„ .</description></item><item><title>[gev] è‡ªå®šä¹‰åè®®æ”¯æŒ</title><link>https://mogutou.xyz/posts/open-source/gev-protocol/</link><pubDate>Thu, 31 Oct 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/open-source/gev-protocol/</guid><description>https://github.com/Allenxuxu/gev
gev æ˜¯ä¸€ä¸ªè½»é‡ã€å¿«é€Ÿçš„åŸºäº Reactor æ¨¡å¼çš„éé˜»å¡ TCP ç½‘ç»œåº“ï¼Œæ”¯æŒè‡ªå®šä¹‰åè®®ï¼Œè½»æ¾å¿«é€Ÿæ­å»ºé«˜æ€§èƒ½æœåŠ¡å™¨ã€‚
TCP ä¸ºä»€ä¹ˆä¼š&amp;quot;ç²˜åŒ…&amp;quot; TCP æœ¬èº«å°±æ˜¯é¢å‘æµçš„åè®®ï¼Œå°±æ˜¯ä¸€ä¸²æ²¡æœ‰ç•Œé™çš„æ•°æ®ã€‚æ‰€ä»¥æœ¬è´¨ä¸Šæ¥è¯´ TCP ç²˜åŒ…æ˜¯ä¸€ä¸ªä¼ªå‘½é¢˜ã€‚
TCP åº•å±‚å¹¶ä¸å…³å¿ƒä¸Šå±‚ä¸šåŠ¡æ•°æ®ï¼Œä¼šå¥—æ¥å­—ç¼“å†²åŒºçš„å®é™…æƒ…å†µè¿›è¡ŒåŒ…çš„åˆ’åˆ†ï¼Œä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡æ•°æ®å¯èƒ½ä¼šè¢«æ‹†åˆ†æˆå¤šæ¬¡è¿›è¡Œå‘é€ï¼Œä¹Ÿå¯èƒ½ä¼šå°†å¤šä¸ªå°çš„ä¸šåŠ¡æ•°æ®å°è£…æˆä¸€ä¸ªå¤§çš„æ•°æ®åŒ…å‘é€ï¼ˆNagleç®—æ³•ï¼‰ã€‚
gev å¦‚ä½•ä¼˜é›…å¤„ç† gev é€šè¿‡å›è°ƒå‡½æ•° OnMessage é€šçŸ¥ç”¨æˆ·æ•°æ®åˆ°æ¥ï¼Œå›è°ƒå‡½æ•°ä¸­ä¼šå°†ç”¨æˆ·æ•°æ®ç¼“å†²åŒºï¼ˆringbufferï¼‰é€šè¿‡å‚æ•°ä¼ é€’è¿‡æ¥ã€‚
ç”¨æˆ·é€šè¿‡å¯¹ ringbuffer æ“ä½œï¼Œæ¥è¿›è¡Œæ•°æ®è§£åŒ…ï¼Œè·å–åˆ°å®Œæ•´ç”¨æˆ·æ•°æ®åå†è¿›è¡Œä¸šåŠ¡æ“ä½œã€‚è¿™æ ·åˆä¸€ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå°±æ˜¯ä¼šè®©ä¸šåŠ¡æ“ä½œå’Œè‡ªå®šä¹‰åè®®è§£æä»£ç å †åœ¨ä¸€èµ·ã€‚
æ‰€ä»¥ï¼Œæœ€è¿‘å¯¹ gev è¿›è¡Œäº†ä¸€æ¬¡è¾ƒå¤§æ”¹åŠ¨ï¼Œä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿä»¥æ’ä»¶çš„å½¢å¼æ”¯æŒå„ç§è‡ªå®šä¹‰çš„æ•°æ®åè®®ï¼Œè®©ä½¿ç”¨è€…å¯ä»¥ä¾¿æ·å¤„ç† TCP ç²˜åŒ…é—®é¢˜ï¼Œä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚
åšæ³•å¦‚ä¸‹ï¼Œå®šä¹‰ä¸€ä¸ªæ¥å£ Protocol
// Protocol è‡ªå®šä¹‰åè®®ç¼–è§£ç æ¥å£ type Protocol interface { UnPacket(c *Connection, buffer *ringbuffer.RingBuffer) (interface{}, []byte) Packet(c *Connection, data []byte) []byte } ç”¨æˆ·åªéœ€å®ç°è¿™ä¸ªæ¥å£ï¼Œå¹¶æ³¨å†Œåˆ° server ä¸­ï¼Œå½“å®¢æˆ·ç«¯æ•°æ®åˆ°æ¥æ—¶ï¼Œgev ä¼šé¦–å…ˆè°ƒç”¨ UnPacket æ–¹æ³•ï¼Œå¦‚æœç¼“å†²åŒºä¸­çš„æ•°æ®è¶³å¤Ÿç»„æˆä¸€å¸§ï¼Œåˆ™å°†æ•°æ®è§£åŒ…ï¼Œå¹¶è¿”å›çœŸæ­£çš„ç”¨æˆ·æ•°æ®ï¼Œç„¶ååœ¨å›è°ƒ OnMessage å‡½æ•°å¹¶å°†æ•°æ®é€šè¿‡å‚æ•°ä¼ é€’ã€‚
ä¸‹é¢ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰åè®®æ’ä»¶ï¼Œæ¥å¯åŠ¨ä¸€ä¸ª Server ï¼š
| æ•°æ®é•¿åº¦ n | payload | | 4å­—èŠ‚ | n å­—èŠ‚ | // protocol.</description></item><item><title>Uber Go é£æ ¼æŒ‡å—</title><link>https://mogutou.xyz/posts/go/uber-go-guide/</link><pubDate>Sun, 13 Oct 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go/uber-go-guide/</guid><description>Uber Go é£æ ¼æŒ‡å— è¯‘æ–‡ï¼šhttps://github.com/Allenxuxu/uber-go-guide åŸæ–‡ï¼šhttps://github.com/uber-go/guide/blob/master/style.md ç®€ä»‹ é£æ ¼æ˜¯æŒ‡è§„èŒƒä»£ç çš„å…±åŒçº¦å®šã€‚é£æ ¼ä¸€è¯å…¶å®æ˜¯æœ‰ç‚¹ç”¨è¯ä¸å½“çš„ï¼Œå› ä¸ºå…±åŒçº¦å®šçš„èŒƒç•´è¿œè¿œä¸æ­¢ gofmt æ‰€åšçš„æºä»£ç æ ¼å¼åŒ–è¿™äº›ã€‚
æœ¬æŒ‡å—æ—¨åœ¨é€šè¿‡è¯¦å°½æè¿° Uber åœ¨ç¼–å†™ Go ä»£ç ä¸­çš„æ³¨æ„äº‹é¡¹ï¼ˆè§„å®šï¼‰æ¥è§£é‡Šå…¶ä¸­å¤æ‚ä¹‹å¤„ã€‚åˆ¶å®šè¿™äº›æ³¨æ„äº‹é¡¹ï¼ˆè§„å®šï¼‰æ˜¯ä¸ºäº†æé«˜ä»£ç å¯ç»´æŠ¤æ€§åŒæ—¶ä¹Ÿè®©å·¥ç¨‹å¸ˆä»¬é«˜æ•ˆçš„ä½¿ç”¨ Go çš„ç‰¹æ€§ã€‚
è¿™ä»½æŒ‡å—æœ€åˆç”± Prashant Varanasi å’Œ Simon Newton ç¼–å†™ï¼Œç›®çš„æ˜¯è®©ä¸€äº›åŒäº‹å¿«é€Ÿä¸Šæ‰‹ Go ã€‚å¤šå¹´æ¥ï¼Œå·²ç»æ ¹æ®å…¶ä»–äººçš„åé¦ˆä¸æ–­ä¿®æ”¹ã€‚
è¿™ä»½æ–‡æ¡£è®°å½•äº†æˆ‘ä»¬åœ¨ Uber éµå®ˆçš„ Go æƒ¯ç”¨å‡†åˆ™ã€‚å…¶ä¸­å¾ˆå¤šå‡†åˆ™æ˜¯ Go çš„é€šç”¨å‡†åˆ™ï¼Œå…¶ä»–æ–¹é¢ä¾èµ–äºå¤–éƒ¨èµ„æºï¼š
Effective Go The Go common mistakes guide æ‰€æœ‰çš„ä»£ç éƒ½åº”è¯¥é€šè¿‡ golint å’Œ go vet æ£€æŸ¥ã€‚æˆ‘ä»¬å»ºè®®æ‚¨è®¾ç½®ç¼–è¾‘å™¨ï¼š
ä¿å­˜æ—¶è‡ªåŠ¨è¿è¡Œ goimports è‡ªåŠ¨è¿è¡Œ golint å’Œ go vet æ¥æ£€æŸ¥é”™è¯¯ æ‚¨å¯ä»¥åœ¨è¿™æ‰¾åˆ°å…³äºç¼–è¾‘å™¨è®¾å®š Go tools çš„ç›¸å…³ä¿¡æ¯ï¼š
https://github.com/golang/go/wiki/IDEsAndTextEditorPlugins
æŒ‡å— æŒ‡å‘æ¥å£ï¼ˆinterfaceï¼‰çš„æŒ‡é’ˆ ä½ åŸºæœ¬æ°¸è¿œä¸éœ€è¦ä¸€ä¸ªæŒ‡å‘æ¥å£çš„æŒ‡é’ˆã€‚ä½ åº”è¯¥ç›´æ¥å°†æ¥å£ä½œä¸ºå€¼ä¼ é€’ï¼Œå› ä¸ºæ¥å£çš„åº•å±‚æ•°æ®å°±æ˜¯æŒ‡é’ˆã€‚
ä¸€ä¸ªæ¥å£åŒ…å«ä¸¤ä¸ªå­—æ®µï¼š
ç±»å‹æŒ‡é’ˆï¼ŒæŒ‡å‘æŸäº›ç‰¹å®šç±»å‹ä¿¡æ¯çš„æŒ‡é’ˆã€‚ æ•°æ®æŒ‡é’ˆã€‚å¦‚æœå­˜å‚¨æ•°æ®æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œé‚£å°±ç›´æ¥å­˜å‚¨ã€‚å¦‚æœå­˜å‚¨æ•°æ®æ˜¯ä¸€ä¸ªå€¼å˜é‡ï¼Œé‚£å°±å­˜å‚¨æŒ‡å‘è¯¥å€¼çš„æŒ‡é’ˆã€‚ å¦‚æœä½ éœ€è¦æ¥å£æ–¹æ³•æ¥ä¿®æ”¹è¿™äº›åº•å±‚æ•°æ®ï¼Œé‚£ä½ å¿…é¡»ä½¿ç”¨æŒ‡é’ˆã€‚</description></item><item><title>Go ç½‘ç»œåº“å¹¶å‘ååé‡æµ‹è¯•</title><link>https://mogutou.xyz/posts/open-source/gev-benchmark/</link><pubDate>Sun, 22 Sep 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/open-source/gev-benchmark/</guid><description>https://github.com/Allenxuxu/gev
æœ¬æ–‡ä¸»è¦æµ‹è¯• gev ç½‘ç»œåº“å’Œå…¶ä»–ä¸‰æ–¹ Go ç½‘ç»œåº“ä»¥åŠæ ‡å‡†åº“çš„ååé‡å¯¹æ¯”ã€‚
æµ‹è¯•å¯¹è±¡ gev ï¼šä¸€ä¸ªè½»é‡ã€å¿«é€Ÿçš„åŸºäº Reactor æ¨¡å¼çš„éé˜»å¡ TCP ç½‘ç»œåº“ eviop ï¼ševio çš„ä¼˜åŒ–ç‰ˆæœ¬ evio ï¼šFast event-loop networking for Go gnet ï¼ševiop çš„ç½‘ç»œæ¨¡å‹æ›¿æ¢ç‰ˆæœ¬ net æ ‡å‡†åº“ æµ‹è¯•æ–¹æ³• é‡‡ç”¨é™ˆç¡•æµ‹è¯• muduo ä½¿ç”¨çš„ ping pong åè®®æ¥æµ‹è¯•ååé‡ã€‚
ç®€å•åœ°è¯´ï¼Œping pong åè®®æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½å®ç° echo åè®®ã€‚å½“ TCP è¿æ¥å»ºç«‹æ—¶ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ä¸€äº›æ•°æ®ï¼ŒæœåŠ¡å™¨ä¼š echo å›è¿™äº›æ•°æ®ï¼Œç„¶åå®¢æˆ·ç«¯å† echo å›æœåŠ¡å™¨ã€‚è¿™äº›æ•°æ®å°±ä¼šåƒä¹’ä¹“çƒä¸€æ ·åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æ¥å›ä¼ é€ï¼Œç›´åˆ°æœ‰ä¸€æ–¹æ–­å¼€è¿æ¥ä¸ºæ­¢ã€‚è¿™æ˜¯ç”¨æ¥æµ‹è¯•ååé‡çš„å¸¸ç”¨åŠæ³•ã€‚
æµ‹è¯•çš„å®¢æˆ·ç«¯ä»£ç ï¼š https://github.com/Allenxuxu/gev/blob/master/benchmarks/client/main.go
æµ‹è¯•è„šæœ¬ï¼šhttps://github.com/Allenxuxu/gev/blob/master/benchmarks/bench-pingpong.sh
ä¸»è¦åšä¸¤é¡¹æµ‹è¯•ï¼š
å•çº¿ç¨‹å•ä¸ª work åç¨‹æµ‹è¯•ï¼Œæµ‹è¯•å¹¶å‘è¿æ¥æ•°ä¸º 10/100/1000/10000 æ—¶çš„ååé‡ 4çº¿ç¨‹4ä¸ª work åç¨‹æµ‹è¯•ï¼Œæµ‹è¯•å¹¶å‘è¿æ¥æ•°ä¸º 10/100/1000/10000 æ—¶çš„ååé‡ æ‰€æœ‰æµ‹è¯•ä¸­ï¼Œping pong æ¶ˆæ¯çš„å¤§å°å‡ä¸º 4096 bytesï¼Œå®¢æˆ·ç«¯å§‹ç»ˆæ˜¯4çº¿ç¨‹è¿è¡Œã€‚</description></item><item><title>å¼€æº gev: Go å®ç°åŸºäº Reactor æ¨¡å¼çš„éé˜»å¡ TCP ç½‘ç»œåº“</title><link>https://mogutou.xyz/posts/open-source/gev/</link><pubDate>Thu, 19 Sep 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/open-source/gev/</guid><description>gev è½»é‡ã€å¿«é€Ÿçš„ Golang ç½‘ç»œåº“ gev æ˜¯ä¸€ä¸ªè½»é‡ã€å¿«é€Ÿçš„åŸºäº Reactor æ¨¡å¼çš„éé˜»å¡ TCP ç½‘ç»œåº“ï¼Œæ”¯æŒè‡ªå®šä¹‰åè®®ï¼Œè½»æ¾å¿«é€Ÿæ­å»ºé«˜æ€§èƒ½æœåŠ¡å™¨ã€‚
ä¸ºä»€ä¹ˆæœ‰ gev Golang çš„ goroutine è™½ç„¶éå¸¸è½»é‡ï¼Œä½†æ˜¯æ¯å¯åŠ¨ä¸€ä¸ª goroutine ä»éœ€è¦ 4k å·¦å³çš„å†…å­˜ã€‚è¯»äº†é¸Ÿçªå¤§ä½¬çš„æ–‡ç« ã€ç™¾ä¸‡ Go TCP è¿æ¥çš„æ€è€ƒ: epollæ–¹å¼å‡å°‘èµ„æºå ç”¨ã€‘åï¼Œä¾¿å»ç ”ç©¶äº†äº†ä¸‹ evioã€‚
evio è™½ç„¶éå¸¸å¿«ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¾¿å°è¯•å»ä¼˜åŒ–å®ƒï¼Œäºæ˜¯æœ‰äº† eviop é¡¹ç›®ã€‚å…³äº evio çš„é—®é¢˜å¯ä»¥çœ‹æˆ‘çš„å¦ä¸€ç¯‡åšæ–‡ ã€Golang ç½‘ç»œåº“evioä¸€äº›é—®é¢˜/bugå’Œæ€è€ƒã€‘ã€‚åœ¨ä¼˜åŒ– evio å®Œæˆ eviop çš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºå…¶ç½‘ç»œæ¨¡å‹çš„ç¼˜æ•…ï¼Œæ„ˆåŠ æ„Ÿè§‰ä¿®æ”¹å®ƒéå¸¸éº»çƒ¦ï¼Œæˆæœ¬æ¯”é‡æ–°æä¸€ä¸ªè¿˜é«˜ã€‚
æœ€ç»ˆå†³å®šè‡ªå·±é‡æä¸€ä¸ªï¼Œæ›´åŠ è½»é‡ï¼Œä¸éœ€è¦çš„å…¨å»æ‰ã€‚åŠ ä¸Šå¤§å­¦æ—¶å­¦ä¹ è¿‡ muduo ï¼Œä¾¿å‚è€ƒ muduo çš„ä½¿ç”¨çš„ Reactor æ¨¡å‹å®ç° gev ã€‚
åœ¨ linux ç¯å¢ƒä¸‹ï¼Œgev åº•å±‚ä½¿ç”¨ epoll ï¼Œè¿™æ˜¯ gev ä¼šä¸“æ³¨ä¼˜åŒ–çš„åœ°æ–¹ã€‚åœ¨ mac ä¸‹åº•å±‚ä½¿ç”¨ kqueueï¼Œå¯èƒ½ä¸ä¼šè¿‡å¤šå…³æ³¨è¿™éƒ¨åˆ†çš„ä¼˜åŒ–ï¼Œæ¯•ç«Ÿå¾ˆå°‘æœ‰ç”¨ mac åšæœåŠ¡å™¨çš„ï¼ˆWindows ç¯å¢ƒ&amp;quot;æš‚&amp;quot;ä¸æ”¯æŒï¼‰ã€‚
ç‰¹ç‚¹ åŸºäº epoll å’Œ kqueue å®ç°çš„é«˜æ€§èƒ½äº‹ä»¶å¾ªç¯ æ”¯æŒå¤šæ ¸å¤šçº¿ç¨‹ åŠ¨æ€æ‰©å®¹ Ring Buffer å®ç°çš„è¯»å†™ç¼“å†²åŒº å¼‚æ­¥è¯»å†™ SO_REUSEPORT ç«¯å£é‡ç”¨æ”¯æŒ æ”¯æŒ WebSocket æ”¯æŒå®šæ—¶ä»»åŠ¡ï¼Œå»¶æ—¶ä»»åŠ¡ æ”¯æŒè‡ªå®šä¹‰åè®®ï¼Œå¤„ç† TCP ç²˜åŒ… ç½‘ç»œæ¨¡å‹ gev åªä½¿ç”¨æå°‘çš„ goroutine, ä¸€ä¸ª goroutine è´Ÿè´£ç›‘å¬å®¢æˆ·ç«¯è¿æ¥ï¼Œå…¶ä»– goroutine ï¼ˆwork åç¨‹ï¼‰è´Ÿè´£å¤„ç†å·²è¿æ¥å®¢æˆ·ç«¯çš„è¯»å†™äº‹ä»¶ï¼Œwork åç¨‹æ•°é‡å¯ä»¥é…ç½®ï¼Œé»˜è®¤ä¸è¿è¡Œä¸»æœº CPU æ•°é‡ç›¸åŒã€‚</description></item><item><title>Go net/http æµ…æ</title><link>https://mogutou.xyz/posts/go/go-http/</link><pubDate>Sun, 15 Sep 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go/go-http/</guid><description>GO HTTP Server ä½¿ç”¨æ ‡å‡†åº“æ„å»º HTTP æœåŠ¡ Go è¯­è¨€æ ‡å‡†åº“è‡ªå¸¦ä¸€ä¸ªå®Œå–„çš„ net/http åŒ…ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿ç¼–å†™ä¸€ä¸ªå¯ä»¥ç›´æ¥è¿è¡Œçš„ Web æœåŠ¡ã€‚
package main import ( &amp;#34;log&amp;#34; &amp;#34;net/http&amp;#34; ) func hello(w http.ResponseWriter, r *http.Request) { log.Println(r.Method, r.Host, r.RequestURI) w.Write([]byte(&amp;#34;hello&amp;#34;)) } func main() { http.HandleFunc(&amp;#34;/hello&amp;#34;, hello) //è®¾ç½®è®¿é—®çš„è·¯ç”± // http.Handle(&amp;#34;/hello&amp;#34;, http.HandlerFunc(hello)) // å’Œä¸Šé¢å†™æ³•ç­‰ä»· err := http.ListenAndServe(&amp;#34;:9090&amp;#34;, nil) //è®¾ç½®ç›‘å¬çš„ç«¯å£å¹¶å¯åŠ¨ HTTP æœåŠ¡ if err != nil { log.Fatal(&amp;#34;ListenAndServe: &amp;#34;, err) } } $ curl -v 127.0.0.1:9090/hello * Trying 127.0.0.1... * TCP_NODELAY set * Connected to 127.</description></item><item><title>Go channel æ‹·è´é—®é¢˜</title><link>https://mogutou.xyz/posts/go/go-channel-copy/</link><pubDate>Wed, 21 Aug 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go/go-channel-copy/</guid><description>Go çš„ channel ä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯æ€»å¬è¯´ channel ä¼šæ‹·è´ä¼ é€’çš„æ•°æ®ï¼Œç”Ÿæ€•é¢‘ç¹æ‹·è´å½±å“æ•ˆç‡ã€‚
ç©¶ç«Ÿæ˜¯æ€ä¹ˆä¸ªæ‹·è´æ³•å‘¢ï¼Œä¸‹é¢ä¼šæœ‰ä¸¤ä¸ª demo éªŒè¯ä¸‹ã€‚
å…ˆè¯´ç»“è®ºï¼š Go channel çš„å‘é€æ¥æ”¶æ•°æ®çš„æ‹·è´å’Œ Go çš„å‡½æ•°ä¼ å‚é“ç†æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é»˜è®¤çš„å€¼æ‹·è´ã€‚ å¦‚æœä½ ä¼ é€’ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆ Go ä¼šå¤åˆ¶ä¸€ä»½æ–°çš„ï¼›å¦‚æœä¼ é€’ä¸€ä¸ªæŒ‡é’ˆï¼Œåˆ™ä¼šæ‹·è´è¿™ä¸ªæŒ‡é’ˆï¼Œä¸ä¼šå»æ‹·è´è¿™ä¸ªæŒ‡é’ˆæ‰€æŒ‡çš„å˜é‡ï¼ˆè¿™ä¸€ç‚¹ C++ é€‰æ‰‹å¯èƒ½ä¼šç†è§£æ¯”è¾ƒæ·±ï¼‰ã€‚
æ‰€ä»¥ï¼Œå¦‚æœä½ éœ€è¦é€šè¿‡ channel ä¼ é€’ä¸€ä¸ªå¾ˆå¤§çš„ struct ï¼Œé‚£ä¹ˆåº”è¯¥ä¼ é€’ æŒ‡é’ˆã€‚ä½†æ˜¯ï¼Œè¦éå¸¸æ³¨æ„é€šè¿‡ channel å‘é€åï¼Œä¸è¦ä¿®æ”¹è¿™ä¸ªæŒ‡ï¼Œè¿™ä¼šå¯¼è‡´çº¿ç¨‹é—´æ½œåœ¨çš„ç«äº‰ã€‚
ä¸‹é¢æ˜¯ä¸¤ä¸ªéªŒè¯çš„å° demoï¼š
é€šè¿‡ channel ä¼ é€’æŒ‡é’ˆ package main import ( &amp;#34;fmt&amp;#34; &amp;#34;time&amp;#34; ) func recv(ch &amp;lt;-chan *int) { time.Sleep(1 * time.Second) out := &amp;lt;-ch fmt.Println(&amp;#34;recv : &amp;#34;, out, *out) } func main() { i := 1 ch := make(chan *int, 2) fmt.</description></item><item><title>æ‹¥æŠ± Go module</title><link>https://mogutou.xyz/posts/go/go-module/</link><pubDate>Tue, 20 Aug 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go/go-module/</guid><description>go get æ‹‰åŒ…ä¸€ç›´æ—¶å›½å†…é€‰æ‰‹å¤´ç–¼çš„é—®é¢˜ï¼Œè™½ç„¶æ¢¯å­å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†æ˜¯æ€»æ˜¯æœ‰å¾ˆæ…¢çš„æ—¶å€™ï¼Œè€Œä¸”éœ€è¦æ¯å°ç”µè„‘éƒ½é…ç½®ï¼Œç‰¹åˆ«æ˜¯ CI çš„æœåŠ¡å™¨ç­‰ï¼Œå¾ˆçƒ¦äººã€‚
ä¸ƒç‰›äº‘å¼€æºäº† goproxy ï¼Œè¿˜å…è´¹æä¾› https://goproxy.cn ä½œä¸ºä»£ç†æ¥æ‹‰åŒ…ã€‚
ä¸è¿‡ GOPROXY åªæœ‰åœ¨ Go module ä¸‹æ‰èƒ½ä½¿ç”¨ï¼Œç´¢æ€§å…¨é¢æ‹¥æŠ± Go module ä¸€åŠ³æ°¸é€¸ã€‚
ä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼Œå³å¯ï¼š
sudo vi /etc/profile åœ¨æœ€åæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œå¼€å¯ Go module å’Œä»£ç†ï¼š
export GO111MODULE=on export GOPROXY=https://goproxy.cn è®©é…ç½®æ–‡ä»¶ç«‹å³ç”Ÿæ•ˆ
source /etc/profile æ¥ä¸‹æ¥å°±å¯ä»¥ç•…å¿« Go äº†ï¼
PSï¼š Go 1.16 å·²ç»é»˜è®¤å¼€å¯ go moudleäº†ã€‚</description></item><item><title>Golang ç½‘ç»œåº“ evio ä¸€äº›é—®é¢˜/bugå’Œæ€è€ƒ</title><link>https://mogutou.xyz/posts/open-source/evio-code-bug/</link><pubDate>Thu, 15 Aug 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/open-source/evio-code-bug/</guid><description>Fast event-loop networking for Go
æœ€è¿‘ç¿»äº† evio çš„æºç ï¼Œå‘ç°ä¸€äº›é—®é¢˜ï¼Œä¸»è¦é›†ä¸­åœ¨ linux å¹³å° epoll ä¸Šå’Œè¯»å†™çš„å¤„ç†ã€‚
ç”¨æ¥å”¤é†’ epoll çš„ eventfd å†™å…¥æ•°æ®æ²¡æœ‰è¯»å‡º listen çš„ fd æ³¨å†Œåˆ°æ‰€æœ‰äº‹ä»¶å¾ªç¯ï¼Œepoll çš„æƒŠç¾¤é—®é¢˜ loopWrite åœ¨å†…æ ¸ç¼“å†²åŒºæ»¡ï¼Œæ— æ³•ä¸€æ¬¡å†™å…¥æ—¶ï¼Œå‡ºç°å†™å…¥æ•°æ®ä¸¢å¤± eventfd çš„ä½¿ç”¨é—®é¢˜ åœ¨ internal/internal_linux.go ä¸­å°è£…äº† epoll çš„ä½¿ç”¨ API ã€‚
// Poll ... type Poll struct { fd int // epoll fd wfd int // wake fd notes noteQueue } åœ¨ OpenPoll æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ª eventfd å¹¶å°† fd èµ‹å€¼ç»™ Poll çš„ wfd æˆå‘˜ï¼Œ å¹¶ä¸”æ³¨å†Œåˆ° epoll ç›‘å¬å¯è¯»äº‹ä»¶ã€‚</description></item><item><title>Golang é«˜æ€§èƒ½ç½‘ç»œåº“ evio æºç è§£æ</title><link>https://mogutou.xyz/posts/open-source/evio-code/</link><pubDate>Tue, 06 Aug 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/open-source/evio-code/</guid><description>é˜…è¯»å‰æï¼šäº†è§£ epoll
evio æ˜¯ä¸€ä¸ªåŸºäºäº‹ä»¶é©±åŠ¨çš„ç½‘ç»œæ¡†æ¶ï¼Œå®ƒéå¸¸è½»é‡è€Œä¸”ç›¸æ¯” Go net æ ‡å‡†åº“æ›´å¿«ã€‚å…¶åº•å±‚ä½¿ç”¨epoll å’Œ kqueue ç³»ç»Ÿè°ƒåº¦å®ç°ã€‚
åŸç† evio æ˜¯ Reactor æ¨¡å¼çš„ç®€å•å®ç°ã€‚Reactor æœ¬è´¨å°±æ˜¯â€œnon-blocking IO + IO multiplexingâ€ï¼Œé€šè¿‡éé˜»å¡IO+ IO å¤šè·¯å¤ç”¨æ¥å¤„ç†å¹¶å‘ã€‚ç¨‹åºè¿è¡Œä¸€ä¸ªæˆ–è€…å¤šä¸ªäº‹ä»¶å¾ªç¯ï¼Œé€šè¿‡åœ¨äº‹ä»¶å¾ªç¯ä¸­æ³¨å†Œå›è°ƒçš„æ–¹å¼å®ç°ä¸šåŠ¡é€»è¾‘ã€‚
evio å°†æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦è®¾ä¸ºéé˜»å¡ï¼Œå¹¶æ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯ï¼ˆ epoll / kqueue ï¼‰ä¸­ã€‚ç›¸è¾ƒäºä¼ ç»Ÿçš„ per thread per connection çš„å¤„ç†æ–¹æ³•ï¼Œçº¿ç¨‹ä½¿ç”¨æ›´å°‘ï¼Œçº¿ç¨‹èµ„æºåˆ©ç”¨ç‡æ›´é«˜ã€‚
evio éœ€è¦åœ¨æœåŠ¡å¯åŠ¨å‰ï¼Œæ³¨å†Œå›è°ƒå‡½æ•°ï¼Œå½“äº‹ä»¶å¾ªç¯ä¸­æœ‰äº‹ä»¶åˆ°æ¥æ—¶ï¼Œä¼šè°ƒç”¨å›è°ƒå‡½æ•°å¤„ç†ã€‚
ä½¿ç”¨ç¤ºä¾‹ å…ˆä»ä¸€ä¸ªç®€å•çš„ echo server çš„ä¾‹å­æ¥äº†è§£ evio ã€‚
package main import ( &amp;#34;flag&amp;#34; &amp;#34;fmt&amp;#34; &amp;#34;log&amp;#34; &amp;#34;strings&amp;#34; &amp;#34;github.com/tidwall/evio&amp;#34; ) func main() { var port int var loops int var udp bool var trace bool var reuseport bool var stdlib bool flag.</description></item><item><title>Golang æç®€å…¥é—¨æ•™ç¨‹</title><link>https://mogutou.xyz/posts/go/go-tutorials/</link><pubDate>Sun, 04 Aug 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go/go-tutorials/</guid><description>Hello World æˆ‘ä»¬ä»¥ä¼ ç»Ÿçš„â€œhello worldâ€æ¡ˆä¾‹å¼€å§‹å§ã€‚
package main import &amp;#34;fmt&amp;#34; func main() { fmt.Println(&amp;#34;Hello World&amp;#34;) } Goçš„æºæ–‡ä»¶ä»¥ .go ä¸ºåç¼€åï¼Œè¿™äº›æ–‡ä»¶åå‡ç”±å°å†™å­—æ¯ï¼ˆæ¨èåšæ³•ï¼‰ç»„æˆä¸”ä¸åŒ…å«ç©ºæ ¼å’Œå…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼Œå¦‚ main.go ã€‚å¦‚æœæ–‡ä»¶åç”±å¤šä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ™ä½¿ç”¨ä¸‹åˆ’çº¿ _ å¯¹å®ƒä»¬è¿›è¡Œåˆ†éš”ï¼Œå¦‚ main_test.go ã€‚
Goæ˜¯ä¸€é—¨ç¼–è¯‘å‹è¯­è¨€,Goè¯­è¨€çš„å·¥å…·é“¾å°†æºä»£ç åŠå…¶ä¾èµ–è½¬æ¢æˆè®¡ç®—æœºçš„æœºå™¨æŒ‡ä»¤ã€‚Goè¯­è¨€æä¾›çš„å·¥å…·éƒ½é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„å‘½ä»¤ go è°ƒç”¨ï¼Œgo å‘½ä»¤æœ‰ä¸€ç³»åˆ—å­å‘½ä»¤ã€‚
$ go help Go is a tool for managing Go source code. Usage: go &amp;lt;command&amp;gt; [arguments] The commands are: bug start a bug report build compile packages and dependencies clean remove object files and cached files doc show documentation for package or symbol env print Go environment information fix update packages to use new APIs fmt gofmt (reformat) package sources generate generate Go files by processing source get download and install packages and dependencies install compile and install packages and dependencies list list packages or modules mod module maintenance run compile and run Go program test test packages tool run specified go tool version print Go version vet report likely mistakes in packages .</description></item><item><title>dokcer swarm éƒ¨ç½²go-microå¾®æœåŠ¡åº”ç”¨</title><link>https://mogutou.xyz/posts/docker/docker-swarm/</link><pubDate>Thu, 18 Jul 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/docker/docker-swarm/</guid><description>å¾®æœåŠ¡åº”ç”¨ä½¿ç”¨å®¹å™¨éƒ¨ç½²éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯å½“åº”ç”¨æœåŠ¡æ³¨å†Œè‡ªèº«åœ°å€(ip:port)åˆ°æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æ—¶å€™ï¼Œå¦‚æœæ³¨å†Œçš„æ˜¯å®¹å™¨å†…çš„ipï¼Œåˆ«çš„æœåŠ¡æ˜¯æ— æ³•è®¿é—®åˆ°çš„ã€‚
è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åœ¨è¿è¡Œå®¹å™¨çš„æ—¶å€™æŒ‡å®šç½‘ç»œæ¨¡å¼ä¸º host (&amp;ndash;net=host) ï¼Œè¿™æ ·å°±å¯ä»¥è·³è¿‡ Docker çš„ç‹¬ç«‹ç½‘ç»œæ ˆï¼Œç›´æ¥é€šè¿‡æœ¬æœºIPç«¯å£å°±å¯ä»¥è®¿é—®ï¼Œä½†æ˜¯è¿™æ ·ä¼šå¤§é‡å ç”¨æœ¬åœ°ç«¯å£ã€‚
æœ€å¥½çš„åœºæ™¯è¿˜æ˜¯åç«¯æœåŠ¡éƒ½åœ¨å®¹å™¨ç½‘ç»œä¸­ï¼Œä»… API ç½‘å…³æš´éœ²ä¸€ä¸ªç«¯å£ä¾›å¤–éƒ¨è®¿é—®ï¼Œä½†æ˜¯åŒæ—¶è¿˜åç«¯æœåŠ¡è¿˜éœ€è¦èƒ½å®ç°è·¨æœºå™¨çš„ç½‘ç»œè¿é€šã€‚
æ—©æœŸ Docker æœ¬èº«çš„å®¹å™¨ç½‘ç»œæœ¬èº«å¹¶ä¸æ”¯æŒè·¨æœºå™¨ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜å¦‚æœå®¹å™¨éƒ¨ç½²åœ¨ä¸åŒçš„èŠ‚ç‚¹ï¼ˆæœåŠ¡å™¨ï¼‰ä¸Šé¢ï¼Œåªèƒ½é€šè¿‡æš´éœ²ç«¯å£åˆ°å®¿ä¸»æœºä¸Šï¼Œå†é€šè¿‡å®¿ä¸»æœºä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚Docker 12.0 ä¹‹åçš„ç‰ˆæœ¬è‡ªå¸¦ Docker Swarmï¼ŒDocker Swarm çš„ Overlay ç½‘ç»œé©±åŠ¨å¯ä»¥å®ç°è·¨ä¸»æœºç½‘ç»œé€šä¿¡ã€‚Kubernetes å›ºç„¶å¥½ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿéå¸¸é‡ï¼Œå­¦ä¹ æˆæœ¬ä¹Ÿå¾ˆå¤§ï¼ŒSwarm åœ¨å°é¡¹ç›®ä¸­è¿˜æ˜¯æœ‰ç”¨æ­¦ä¹‹åœ°çš„ã€‚
dokcer swarm é›†ç¾¤æ­å»º å‡†å¤‡ä¸¤å°å®‰è£…æœ‰ docker çš„æœºå™¨ï¼š 192.168.0.1 192.168.0.2
192.168.0.1 åˆ›å»ºmasterèŠ‚ç‚¹
# docker swarm init # docker swarm join \ --token SWMTKN-1-3uu3gjkdt6xgk06wd1c9gfog8xec99ga69ilcclyzyk181n5ki-6f7frw75gvpdwsl1yvpf885lw \ 192.168.0.1:2377 This node joined a swarm as a worker. å¤åˆ¶ä¸Šé¢çš„ docker swarm join &amp;hellip; åœ¨ 192.168.0.2 ä¸Šæ‰§è¡Œï¼Œå³å°†æœ¬æœºåŠ å…¥ swarm é›†ç¾¤ã€‚
è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæœ€åŸºç¡€çš„ swarm çš„é›†ç¾¤ï¼Œæ‰§è¡Œå‘½ä»¤æŸ¥çœ‹ï¼š
# docker node ls ID HOSTNAME STATUS AVAILABILITY MANAGER STATUS r76ighlnw0p2r0tbd9wmoqaep server2 Ready Active rzqbzl58hlu89xoty4cedn0er * server1 Ready Active Leader åˆ›å»º overlay ç½‘ç»œ å…ˆåˆ›å»ºä¸€ä¸ªå¯ä»¥è·¨æœºå™¨çš„ overlay ç½‘ç»œ</description></item><item><title>Go Micro hystrix ç†”æ–­</title><link>https://mogutou.xyz/posts/go-micro/go-micro-hystrix/</link><pubDate>Thu, 27 Jun 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go-micro/go-micro-hystrix/</guid><description>hystrix-go hystrixæ˜¯Netflixå¼€æºçš„ä¸€ä¸ªJAVAé¡¹ç›®ï¼Œä¸è¿‡GitHubä¹Ÿæœ‰golangçš„å®ç°ç‰ˆæœ¬hystrix-go
hystrix-dashboard hystrixå¹¶æ²¡æœ‰è‡ªå¸¦ä¸€ä¸ªä»ªè¡¨ç›˜ï¼Œæ— æ³•ç›´è§‚çš„æŸ¥çœ‹æ¥å£çš„å¥åº·çŠ¶å†µã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é‡‡ç”¨GitHubçš„ä¸€ä¸ªå¼€æºå®ç°hystrix-dashboardã€‚
docker run --name hystrix-dashboard -d -p 8081:9002 mlabouardy/hystrix-dashboard:latest micro APIç½‘å…³æ’ä»¶ å…³äºhystrixçš„å·¥ä½œåŸç†ï¼Œå¯ä»¥æŸ¥é˜…ç›¸å…³èµ„æ–™ï¼Œè¿™é‡Œåªè®²è§£å¦‚ä½•å°è£…æ’ä»¶åœ¨micro APIç½‘å…³ä¸­ä½¿ç”¨ã€‚
err := hystrix.Do(&amp;quot;my_command&amp;quot;, func() error { // talk to other services return nil }, nil) ä½¿ç”¨hystrix.Do() åŒæ­¥APIï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯command, åº”è¯¥æ˜¯ä¸å½“å‰è¯·æ±‚ä¸€ä¸€å¯¹åº”çš„ä¸€ä¸ªåç§°ï¼Œå¦‚å…¥â€œGET-/testâ€ã€‚ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°åŒ…å«æˆ‘æˆ‘ä»¬è‡ªå·±çš„é”™è¯¯é€»è¾‘ï¼Œå½“è¯·æ±‚å¤±è´¥æ—¶åº”è¯¥è¿”å›errorã€‚hystrixä¼šæ ¹æ®æˆ‘ä»¬çš„å¤±è´¥ç‡æ‰§è¡Œç†”æ–­ç­–ç•¥ã€‚
å°è£…Handler // BreakerWrapper hystrix breaker func BreakerWrapper(h http.Handler) http.Handler { return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) { name := r.Method + &amp;quot;-&amp;quot; + r.RequestURI log.Println(name) err := hystrix.Do(name, func() error { sct := &amp;amp;status_code.StatusCodeTracker{ResponseWriter: w, Status: http.StatusOK} h.</description></item><item><title>Go Micro æœåŠ¡å¥åº·æ£€æŸ¥</title><link>https://mogutou.xyz/posts/go-micro/go-micro-ttl/</link><pubDate>Thu, 27 Jun 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go-micro/go-micro-ttl/</guid><description>æœåŠ¡å¥åº·æ£€æŸ¥ åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæ¯ä¸ªæœåŠ¡éƒ½ä¼šå­˜åœ¨å¤šä¸ªå®ä¾‹ï¼Œå¯èƒ½éƒ¨ç½²åœ¨ä¸åŒçš„ä¸»æœºä¸­ã€‚å› ä¸ºç½‘ç»œæˆ–è€…ä¸»æœºç­‰ä¸ç¡®å®šå› ç´ ï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯èƒ½ä¼šå‡ºç°æ•…éšœã€‚æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿç›‘æ§æ¯ä¸ªæœåŠ¡å®ä¾‹çš„å¥åº·çŠ¶æ€ï¼Œå½“ä¸€ä¸ªæœåŠ¡æ•…éšœæ—¶ï¼ŒåŠæ—¶å°†å®ƒä»æ³¨å†Œä¸­å¿ƒåˆ é™¤ã€‚
å®ç° microæä¾›ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ç›´æ¥å®ç°å¥åº·æ£€æŸ¥åŠŸèƒ½
micro.RegisterTTL(time.Second*30), micro.RegisterInterval(time.Second*20), Intervalå°±æ˜¯é—´éš”å¤šä¹…æœåŠ¡ä¼šé‡æ–°æ³¨å†Œ TTLå°±æ˜¯æ³¨å†ŒæœåŠ¡çš„è¿‡æœŸæ—¶é—´ï¼Œå¦‚æœæœåŠ¡æŒ‚äº†ï¼Œè¶…è¿‡è¿‡æœŸæ—¶é—´åï¼Œæ³¨å†Œä¸­å¿ƒä¹Ÿä¼šå°†æœåŠ¡åˆ é™¤
microå†…éƒ¨æœåŠ¡æ³¨å†Œçš„æµç¨‹ å½“æˆ‘ä»¬æ‰§è¡Œservice.Run() æ—¶å†…éƒ¨ä¼šæ‰§è¡ŒStart() åœ¨Startå‡½æ•°ä¸­åˆä¼šæ‰§è¡Œs.opts.Server.Start()ï¼Œæ–¹æ³•çš„å®ç°åœ¨go-micro/server/rpc_server.goä¸­ã€‚ æˆ‘ä»¬è·³è½¬åˆ°å†…éƒ¨serverçš„Startæ–¹æ³• å¯ä»¥å‘ç°microä½¿ç”¨ä¸€ä¸ªå®šæ—¶å™¨æŒ‰ç…§é—´éš”æ—¶é—´å»è‡ªåŠ¨é‡æ–°æ³¨å†Œã€‚å½“æœåŠ¡æ„å¤–æ•…éšœï¼Œæ— æ³•å‘æ³¨å†Œä¸­å¿ƒé‡æ–°æ³¨å†Œæ—¶ï¼Œå¦‚æœè¶…è¿‡äº†è®¾å®šçš„TTLæ—¶é—´ï¼Œæ³¨å†Œä¸­å¿ƒå°±ä¼šå°†æœåŠ¡åˆ é™¤ã€‚
ä¿®æ”¹æºç  service := grpc.NewService( micro.Name(&amp;quot;go.micro.srv.hello&amp;quot;), micro.WrapHandler(ocplugin.NewHandlerWrapper(t)), + micro.RegisterTTL(time.Second*15), + micro.RegisterInterval(time.Second*10), // micro.Version(&amp;quot;latest&amp;quot;), ) service := web.NewService( web.Name(name), web.Version(&amp;quot;lastest&amp;quot;), + web.RegisterTTL(time.Second*15), + web.RegisterInterval(time.Second*10), web.MicroService(grpc.NewService()), )</description></item><item><title>Golangå®ç°é»˜è®¤å‚æ•°</title><link>https://mogutou.xyz/posts/go/go-options/</link><pubDate>Thu, 27 Jun 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go/go-options/</guid><description>åœ¨golang ä¸­æ˜¯ä¸æ”¯æŒé»˜è®¤å‚æ•°çš„ï¼Œmicroä¸­æœ‰ä¸€ç§ä¼˜é›…çš„å®ç°æ–¹æ³•(å¹¶é micro é¦–åˆ›)ï¼Œå«åš Functional Options Patterã€‚Functional Options å¯ä»¥ç”¨æ¥å®ç°ç®€æ´çš„æ”¯æŒé»˜è®¤å‚æ•°çš„å‡½æ•°æ–¹æ³•ã€‚
options package server import ( &amp;#34;time&amp;#34; ) type Options struct { ConnectTimeOut time.Duration Name string Address string } type Option func(*Options) func newOptions(opt ...Option) Options { opts := Options{} for _, o := range opt { o(&amp;amp;opts) } if len(opts.Address) == 0 { opts.Address = DefaultAddress } if len(opts.Name) == 0 { opts.Name = DefaultName } if opts.ConnectTimeOut == time.Duration(0) { opts.</description></item><item><title>Go Micro APIç½‘ç®¡å¢åŠ  JWT é‰´æƒ</title><link>https://mogutou.xyz/posts/go-micro/go-micro-gateway-jwt/</link><pubDate>Mon, 24 Jun 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go-micro/go-micro-gateway-jwt/</guid><description>micro APIç½‘å…³ micro APIç½‘å…³æ˜¯åŸºäºgo-microå¼€å‘çš„ï¼Œå…·æœ‰æœåŠ¡å‘ç°ï¼Œè´Ÿè½½å‡è¡¡å’ŒRPCé€šä¿¡çš„èƒ½åŠ›ã€‚
ä¸šç•Œæ™®éåšæ³•æ˜¯å°†é‰´æƒï¼Œé™æµï¼Œç†”æ–­ç­‰åŠŸèƒ½ä¹Ÿçº³å…¥APIç½‘å…³ã€‚micro APIç½‘å…³æœ¬èº«æ˜¯å¯æ’æ‹”çš„ï¼Œå¯ä»¥é€šè¿‡æ–°å¢æ’ä»¶çš„æ–¹å¼åŠ å…¥å…¶ä»–åŠŸèƒ½ã€‚
JWT (JSON Web Token) JWTæ˜¯æ˜¯å¾®æœåŠ¡ä¸­å¸¸ç”¨çš„æˆæƒæŠ€æœ¯ï¼Œå…³äºJWTçš„æŠ€æœ¯åŸç†å¯ä»¥å‚è€ƒé˜®ä¸€å³°çš„åšæ–‡
JWTåº“å°è£… lib/token ç›®å½•ä¸‹å°è£…äº†JWTçš„åº“ã€‚æœ‰ä¸€ç‚¹ç‰¹æ®Šçš„æ˜¯ï¼Œåº“ä¸­åˆ©ç”¨consulçš„KVå­˜å‚¨å’Œmicroçš„go-configåº“å®ç°äº†åŠ¨æ€æ›´æ–°JWTçš„PrivateKeyåŠŸèƒ½ï¼Œå®é™…ç”Ÿäº§ä¸­è¿˜æ˜¯åº”è¯¥ä½¿ç”¨æ‹¥æœ‰å‘å¸ƒå’Œæƒé™ç®¡ç†çš„é…ç½®ä¸­å¿ƒã€‚ go-config æ˜¯microä½œè€…å®ç°çš„ä¸€ä¸ªå¯åŠ¨æ€åŠ è½½ã€å¯æ’æ‹”çš„é…ç½®åº“ï¼Œå¯ä»¥ä»å¤šç§æ ¼å¼æ–‡ä»¶æˆ–è€…è¿œç¨‹æœåŠ¡è·å–é…ç½®ã€‚è¯¦æƒ…å¯ä»¥å‚è€ƒæ–‡æ¡£ä¸­æ–‡æ–‡æ¡£|è‹±æ–‡æ–‡æ¡£ PrivateKeyæ˜¯JWTåœ¨ç¼–è§£ç æ—¶ä½¿ç”¨çš„ç§é’¥ï¼Œä¸€æ—¦æ³„æ¼ï¼Œå®¢æˆ·ç«¯ä¾¿å¯ä»¥åˆ©ç”¨è¿™ä¸ªç§é’¥ç¯¡æ”¹ã€ä¼ªé€ Tokenã€‚æ‰€ä»¥ä¸€èˆ¬ç”Ÿäº§ç¯å¢ƒä¸­éƒ½å¿…é¡»å…·å¤‡åŠ¨æ€æ›´æ–°ç§é’¥çš„èƒ½åŠ›ï¼Œä¸€æ—¦å‘ç°æ³„æ¼å¯ä»¥ç«‹å³æ›´æ”¹ï¼Œæˆ–è€…å®šæœŸæ›´æ¢ç§é’¥ï¼Œæé«˜å®‰å…¨æ€§ã€‚ // InitConfig åˆå§‹åŒ– func (srv *Token) InitConfig(address string, path ...string) { consulSource := consul.NewSource( consul.WithAddress(address), ) srv.conf = config.NewConfig() err := srv.conf.Load(consulSource) if err != nil { log.Fatal(err) } value := srv.conf.Get(path...).Bytes() if err != nil { log.Fatal(err) } srv.put(value) log.Println(&amp;quot;JWT privateKey:&amp;quot;, string(srv.get())) srv.enableAutoUpdate(path...) } func (srv *Token) enableAutoUpdate(path .</description></item><item><title>Go Micro jaeger åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª</title><link>https://mogutou.xyz/posts/go-micro/go-micro-jaeger/</link><pubDate>Mon, 24 Jun 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go-micro/go-micro-jaeger/</guid><description>å®‰è£…jaeger jaegeræä¾›ä¸€ä¸ªall in one çš„dockeré•œåƒï¼Œå¯ä»¥å¿«é€Ÿæ­å»ºå®éªŒç¯å¢ƒ
docker run -d --name jaeger -e COLLECTOR_ZIPKIN_HTTP_PORT=9411 -p 5775:5775/udp -p 6831:6831/udp -p 6832:6832/udp -p 5778:5778 -p 16686:16686 -p 14268:14268 -p 9411:9411 jaegertracing/all-in-one:1.6 OpenTracing OpenTracingé€šè¿‡æä¾›å¹³å°æ— å…³ã€å‚å•†æ— å…³çš„APIï¼Œä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿæ–¹ä¾¿çš„æ·»åŠ ï¼ˆæˆ–æ›´æ¢ï¼‰è¿½è¸ªç³»ç»Ÿçš„å®ç°ã€‚ OpenTracingæä¾›äº†ç”¨äºè¿è¥æ”¯æ’‘ç³»ç»Ÿçš„å’Œé’ˆå¯¹ç‰¹å®šå¹³å°çš„è¾…åŠ©ç¨‹åºåº“ã€‚ jaegerå…¼å®¹OpenTracing APIï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨OpenTracingçš„ç¨‹åºåº“å¯ä»¥æ–¹ä¾¿çš„æ›¿æ¢è¿½è¸ªå·¥å…·ã€‚ OpenTracingä¸­æ–‡æ–‡æ¡£
jaegerä½¿ç”¨ å°ä½ä¸€ä¸‹jaegerçš„åˆå§‹åŒ–æ“ä½œæ–¹ä¾¿ä½¿ç”¨ï¼Œè¯¦ç»†ç”¨æ³•å¯ä»¥æŸ¥çœ‹ jaeger-client-go
// lib/tracer // NewTracer åˆ›å»ºä¸€ä¸ªjaeger Tracer func NewTracer(servicename string, addr string) (opentracing.Tracer, io.Closer, error) { cfg := jaegercfg.Configuration{ ServiceName: servicename, Sampler: &amp;amp;jaegercfg.SamplerConfig{ Type: jaeger.SamplerTypeConst, Param: 1, }, Reporter: &amp;amp;jaegercfg.ReporterConfig{ LogSpans: true, BufferFlushInterval: 1 * time.</description></item><item><title>Go Micro é‡è¯•æœºåˆ¶</title><link>https://mogutou.xyz/posts/go-micro/go-micro-retry/</link><pubDate>Thu, 20 Jun 2019 11:22:38 +0800</pubDate><guid>https://mogutou.xyz/posts/go-micro/go-micro-retry/</guid><description>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç»å¸¸ä¼šæœ‰æœåŠ¡å‡ºç°æ•…éšœï¼Œæ‰€ä»¥è‰¯å¥½çš„é‡è¯•æœºåˆ¶å¯ä»¥å¤§å¤§çš„æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚æœ¬æ–‡ä¸»è¦åˆ†æmicroçš„å®¢æˆ·ç«¯é‡è¯•æœºåˆ¶ï¼Œä»¥åŠå®ä¾‹æ¼”ç¤ºã€‚
micro é‡è¯•å®ç° microæ¡†æ¶æä¾›æ–¹æ³•è®¾ç½®å®¢æˆ·ç«¯é‡è¯•çš„æ¬¡æ•°ã€‚
Client.Init( client.Retries(3), ) å½“clientè¯·æ±‚å¤±è´¥æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šæ ¹æ®selectorçš„ç­–ç•¥é€‰æ‹©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹é‡è¯•è¯·æ±‚ã€‚è¿™æ ·å½“ä¸€ä¸ªæœåŠ¡å®ä¾‹æ•…éšœæ—¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥è‡ªåŠ¨è°ƒç”¨å¦ä¸€ä¸ªå®ä¾‹ã€‚
æˆ‘ä»¬æ¥çœ‹çœ‹micro å®¢æˆ·ç«¯å†…éƒ¨é‡è¯•çš„å®ç°ï¼š
go-micro\client\rpc_client.go
func (r *rpcClient) Call(ctx context.Context, request Request, response interface{}, opts ...CallOption) error { ... //å®¢æˆ·ç«¯call è°ƒç”¨å‡½æ•°ï¼Œ åœ¨ä¸‹é¢çš„å¾ªç¯ä¸­è°ƒç”¨ call := func(i int) error { // call backoff first. Someone may want an initial start delay t, err := callOpts.Backoff(ctx, request, i) if err != nil { return errors.InternalServerError(&amp;quot;go.micro.client&amp;quot;, &amp;quot;backoff error: %v&amp;quot;, err.Error()) } // only sleep if greater than 0 if t.</description></item><item><title>å¹³å¹³æ— å¥‡çš„ç¨‹åºå‘˜</title><link>https://mogutou.xyz/about/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mogutou.xyz/about/</guid><description>Email - 120582243@qq.com
Github - https://github.com/Allenxuxu
æˆ‘çš„å¼€æºé¡¹ç›® ğŸš€æ¯”æ ‡å‡†åº“æ›´å¿«çš„ tcp/websocket ç½‘ç»œåº“ï¼šgev Go å¾®æœåŠ¡æ¡†æ¶ï¼šstark å·¥ä½œç›¸å…³ å°±èŒäº å­—èŠ‚è·³åŠ¨ï¼Œæœ‰éœ€è¦å†…æ¨çš„å°ä¼™ä¼´è‡ªå–å†…æ¨ä¿¡æ¯å“ˆï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è”ç³»æˆ‘ã€‚
å­—èŠ‚è·³åŠ¨ å†…æ¨
ç¤¾æ‹›ï¼š https://job.toutiao.com/s/eRUBN97
æ ¡æ‹›å†…æ¨ç : DZ2MHGB æŠ•é€’é“¾æ¥: https://jobs.toutiao.com/s/eRULyxU</description></item></channel></rss>